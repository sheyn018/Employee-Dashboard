<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Performance Evaluation</title>
  <link rel="stylesheet" href="../assets/css/style.css">
  <link rel="stylesheet" href="../css/modules.css">
</head>
<body>
<div class="container">
  <h2>‚≠ê Performance Evaluation</h2>
  <form id="perfForm">
    <label>Employee ID</label>
    <input type="number" name="employee_id" required>
    <label>Evaluator</label>
    <input type="text" name="evaluator" required>
    <label>Evaluation Date</label>
    <input type="date" name="evaluation_date" required>
    <label>Score (1-100)</label>
    <input type="number" name="score" min="1" max="100" required>
    <label>Remarks</label>
    <textarea name="remarks"></textarea>
    <button type="submit">Save Evaluation</button>
  </form>

  <h3>Evaluation Records</h3>
  <table id="perfTable">
    <thead>
      <tr>
        <th>ID</th>
        <th>Employee</th>
        <th>Evaluator</th>
        <th>Date</th>
        <th>Score</th>
        <th>Remarks</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<script>
document.getElementById("perfForm").addEventListener("submit", async function(e){
  e.preventDefault();
  let formData = new FormData(this);
  let res = await fetch("../api/api.php?action=add_performance", { method: "POST", body: formData });
  let data = await res.json();
  alert(data.message);
  loadData();
});

async function loadData(){
  let res = await fetch("../api/api.php?action=get_performance");
  let data = await res.json();
  let tbody = document.querySelector("#perfTable tbody");
  tbody.innerHTML = "";
  data.data.forEach(row => {
    tbody.innerHTML += `<tr>
      <td>${row.id}</td>
      <td>${row.employee_id}</td>
      <td>${row.evaluator}</td>
      <td>${row.evaluation_date}</td>
      <td>${row.score}</td>
      <td>${row.remarks}</td>
    </tr>`;
  });
}
loadData();
</script>
</body>
</html>
